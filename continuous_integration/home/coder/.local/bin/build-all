#!/usr/bin/env bash

build_all() {
    set -xeuo pipefail;

    cd ~/;

    if type conda >/dev/null 2>&1; then
        make-conda-env;
    fi

    mamba run -n "${DEFAULT_CONDA_ENV:-legate}" --cwd ~/ --live-stream build-legate-cpp;
    mamba run -n "${DEFAULT_CONDA_ENV:-legate}" --cwd ~/ --live-stream build-legate-wheel;
    mamba run -n "${DEFAULT_CONDA_ENV:-legate}" --cwd ~/ --live-stream build-legate-conda;
}

(build_all "$@");
