#!/usr/bin/env bash

set -xeuo pipefail

if type conda 2>&1 | grep -q function; then
    echo "conda already installed"
else
    curl -o $HOME/miniconda.sh https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh 
    #wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O $HOME//miniconda.sh
    chmod +x $HOME/miniconda.sh
    $HOME/miniconda.sh -b -p $HOME/miniconda
    echo "CONDA_EXE=$CONDA_EXE"

    #if [ -n "${CONDA_EXE:-}" ]; then
    if test -f $HOME/miniconda/bin/conda; then
        export PATH="$PATH:$HOME/miniconda/bin/conda";
cat <<EOF >> $HOME/.bashrc
    export PATH="$PATH:$HOME/miniconda/bin/conda";
EOF
    fi

    echo "Verify Path is set"
    cat $HOME/.bashrc
fi
